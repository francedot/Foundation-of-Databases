
DROP TABLE E1;
DROP TABLE BE1;

-- CREATE TABLE E3(

	-- D INT NOT NULL,
	-- E INT NOT NULL,
	-- K1R1 INT NOT NULL REFERENCES E1,

-- );

CREATE TABLE E1(

	K1 INT NOT NULL PRIMARY KEY,
	A INT NOT NULL,
	TIPO SMALLINT NOT NULL CHECK (TIPO IN(2, 3)), --TOTALE ESCLUSIVA!
	
	C INT,
	
	D INT,
	E INT,
	K1R1 INT REFERENCES E1, --VINCOLO AGGIUNTIVO DEVE REFERENZIARE IN PARTICOLARE UN ISTANZA DI E2! CI VUOLE UN TRIGGER!
	
	CONSTRAINT E2E3
		CHECK ((TIPO = 2 AND C IS NOT NULL AND D IS NULL AND E IS NULL AND K1R1 IS NULL) OR
			   (TIPO = 3 AND C IS NULL AND D IS NOT NULL AND E IS NOT NULL AND K1R1 IS NOT NULL))
	
);

CREATE TABLE BE1(

	B INT NOT NULL,
	K1B INT NOT NULL REFERENCES E1,
	
	PRIMARY KEY(B, K1B)
	
);



