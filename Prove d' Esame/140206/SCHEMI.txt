DROP TABLE E1;
DROP TABLE R1;

CREATE TABLE E1(

	K1 INT NOT NULL PRIMARY KEY,
	A INT NOT NULL,
	B INT NOT NULL,
	TIPO SMALLINT CHECK(TIPO IN (1, 2)),
	C INT,
	D INT,
	K1R2 INT REFERENCES E1,--NON E' CHIAVE!!! SOLO SE TRAD INDIPENDENTE!!!!
	
	CONSTRAINT E2
		CHECK((TIPO = 1 AND C IS NULL AND D IS NULL AND K1R2 IS NULL) OR
			  (TIPO = 2 AND C IS NOT NULL AND D IS NOT NULL AND K1R2 IS NOT NULL))
	
);

CREATE TABLE R1(

	E INT,
	K1X INT NOT NULL REFERENCES E1,
	K1Y INT NOT NULL REFERENCES E1,
	
	PRIMARY KEY(K1X, K1Y)
	
);

--NO
-- CREATE TABLE E2(

	-- C INT NOT NULL,
	-- D INT NOT NULL,
	-- K1R2 INT NOT NULL,
	
-- );