DROP TABLE E1;
DROP TABLE E3;

CREATE TABLE E1(

	K1 INT NOT NULL PRIMARY KEY,
	A INT NOT NULL,
	
	TIPO2 SMALLINT NOT NULL CHECK(TIPO2 IN(0, 1)),--QUANDO SUBSET METTI SELETTORE
	--1 ISTANZA ANCHE DI E2
	
	B1 INT,
	B2 INT,-- DEVONO ESSERE NULLI E DEFINITI ENTRAMBI!
	
	CONSTRAINT E2
		CHECK(TIPO2 = 0 AND B1 IS NULL AND B2 IS NULL),
		--SE TIPO = 2 POSSONO ESSERE ENTRAMBI NULLI O ENTRAMBI DEFINITI
		--GESTITO DA ALTRO CONSTRAINT!
	
	CONSTRAINT B --COESISTENZA!
		CHECK((B1 IS NOT NULL AND B2 IS NOT NULL) OR
			  (B1 IS NULL AND B2 IS NULL))
	
);

CREATE TABLE E3(

	K3 INT NOT NULL PRIMARY KEY,
	D INT NOT NULL,
	
	E INT NOT NULL,
	K1R INT NOT NULL REFERENCES E1

);

