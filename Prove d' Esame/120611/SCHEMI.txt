DROP TABLE E3;
DROP TABLE E1;

CREATE TABLE E3(
	
	K3 INT NOT NULL PRIMARY KEY,
	D INT NOT NULL

);

CREATE TABLE E1(

	K1 INT NOT NULL PRIMARY KEY,
	A INT NOT NULL,
	--IL NOT NULL!!!
	TIPO2 SMALLINT NOT NULL CHECK (TIPO2 IN (0, 1)), --1 ISTANZA ANCHE DI E2
	B INT,
	
	C INT, --PUO' SEMPRE ESSERE NULLO!
	K3R INT REFERENCES E3,

	--N.B SE PERO' NON SI TRATTA DI UN ISTANZA DI E2 C E' PER FORZA NULLO!
	--INVECE NULLA POSSO DIRE SU C SE SI TRATTA DI UN ISTANZA DI E2!!!
	
	CONSTRAINT E2
		CHECK ((TIPO2 = 0 AND B IS NULL AND K3R IS NULL AND C IS NULL) OR
			   (TIPO2 = 1 AND B IS NOT NULL AND K3R IS NOT NULL))
	
);